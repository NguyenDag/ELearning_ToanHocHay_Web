@{
    Layout = null;
}

<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Hồ sơ cá nhân - ToanHocHay</title>
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Nunito:wght@400;600;700;800&display=swap" rel="stylesheet">

    <style>
        body {
            font-family: 'Nunito', sans-serif;
        }

        .fade-in {
            animation: fadeIn 0.3s ease-in-out;
        }

        @@keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(5px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .nav-item.active {
            background-color: #EFF6FF; /* blue-50 */
            color: #2563EB; /* blue-600 */
            border-left: 4px solid #2563EB;
            font-weight: 700;
        }
    </style>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: '#3B82F6',
                        secondary: '#F97316',
                    }
                }
            }
        }
    </script>
</head>
<body class="bg-gray-50 min-h-screen flex flex-col">

    <!-- 1. HEADER (Giản lược) -->
    <header class="h-16 bg-white shadow-sm flex items-center justify-between px-4 lg:px-8 shrink-0 sticky top-0 z-20">
        <div class="flex items-center gap-2 cursor-pointer" onclick="window.location.href='/'">
            <i class="fa-solid fa-shapes text-2xl text-yellow-400"></i>
            <span class="text-xl font-bold text-primary">ToanHocHay</span>
        </div>

        <!-- User Dropdown (Demo) -->
        <div class="flex items-center gap-3">
            <span class="text-gray-600 font-semibold hidden md:block">Nguyễn Văn An</span>
            <img src="https://api.dicebear.com/7.x/fun-emoji/svg?seed=Felix" class="w-9 h-9 rounded-full border border-gray-200 bg-blue-50">
        </div>
    </header>

    <!-- 2. MAIN CONTAINER -->
    <main class="flex-1 container mx-auto p-4 md:p-8 max-w-5xl">

        <!-- Breadcrumb -->
        <div class="mb-6 flex items-center text-sm text-gray-500">
            <a href="/" class="hover:text-primary"><i class="fa-solid fa-house mr-1"></i>Trang chủ</a>
            <span class="mx-2">/</span>
            <span class="text-gray-800 font-bold">Hồ sơ cá nhân</span>
        </div>

        <div class="flex flex-col md:flex-row gap-6">

            <!-- LEFT: SIDEBAR NAVIGATION -->
            <aside class="w-full md:w-64 bg-white rounded-xl shadow-sm h-fit overflow-hidden shrink-0">
                <!-- User Quick Info -->
                <div class="p-6 text-center border-b border-gray-100 bg-gradient-to-b from-blue-50 to-white">
                    <div class="relative w-24 h-24 mx-auto mb-3 group cursor-pointer">
                        <img src="https://api.dicebear.com/7.x/fun-emoji/svg?seed=Felix" class="w-full h-full rounded-full border-4 border-white shadow-md">
                        <div class="absolute inset-0 bg-black/40 rounded-full flex items-center justify-center opacity-0 group-hover:opacity-100 transition duration-200">
                            <i class="fa-solid fa-camera text-white text-xl"></i>
                        </div>
                    </div>
                    <h2 class="text-lg font-bold text-gray-800">Nguyễn Văn An</h2>
                    <p class="text-sm text-gray-500">Học sinh Lớp 6A</p>
                </div>

                <!-- Menu -->
                <nav class="p-2">
                    <ul class="space-y-1">
                        <li>
                            <button onclick="switchTab('general')" id="nav-general" class="nav-item active w-full text-left px-4 py-3 rounded-lg text-gray-600 hover:bg-gray-50 transition flex items-center">
                                <i class="fa-solid fa-user w-6"></i> Thông tin chung
                            </button>
                        </li>
                        <li>
                            <button onclick="switchTab('security')" id="nav-security" class="nav-item w-full text-left px-4 py-3 rounded-lg text-gray-600 hover:bg-gray-50 transition flex items-center">
                                <i class="fa-solid fa-shield-halved w-6"></i> Đổi mật khẩu
                            </button>
                        </li>
                        <li>
                            <button onclick="switchTab('parent')" id="nav-parent" class="nav-item w-full text-left px-4 py-3 rounded-lg text-gray-600 hover:bg-gray-50 transition flex items-center">
                                <i class="fa-solid fa-user-group w-6"></i> Liên kết phụ huynh
                                <span class="ml-auto bg-red-100 text-red-600 text-xs font-bold px-2 py-0.5 rounded-full">!</span>
                            </button>
                        </li>
                    </ul>

                    <div class="border-t border-gray-100 mt-2 pt-2">
                        <button class="w-full text-left px-4 py-3 rounded-lg text-red-500 hover:bg-red-50 transition flex items-center">
                            <i class="fa-solid fa-right-from-bracket w-6"></i> Đăng xuất
                        </button>
                    </div>
                </nav>
            </aside>

            <!-- RIGHT: CONTENT AREA -->
            <div class="flex-1 bg-white rounded-xl shadow-sm p-6 md:p-8 min-h-[500px]">

                <!-- TAB 1: THÔNG TIN CHUNG -->
                <div id="tab-general" class="fade-in block">
                    <h3 class="text-xl font-bold text-gray-800 mb-1">Thông tin cá nhân</h3>
                    <p class="text-sm text-gray-500 mb-6">Cập nhật thông tin để hệ thống gợi ý bài học phù hợp.</p>

                    <form onsubmit="handleSave(event)">
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-6">
                            <div>
                                <label class="block text-gray-700 text-sm font-bold mb-2">Họ và tên</label>
                                <input type="text" value="Nguyễn Văn An" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-200 focus:border-primary outline-none transition">
                            </div>
                            <div>
                                <label class="block text-gray-700 text-sm font-bold mb-2">Email (Tên đăng nhập)</label>
                                <input type="email" value="an.nguyen@email.com" disabled class="w-full px-4 py-2 border border-gray-200 bg-gray-100 text-gray-500 rounded-lg cursor-not-allowed">
                            </div>
                            <div>
                                <label class="block text-gray-700 text-sm font-bold mb-2">Trường học</label>
                                <input type="text" value="THCS Cầu Giấy" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-200 focus:border-primary outline-none transition">
                            </div>
                            <div>
                                <label class="block text-gray-700 text-sm font-bold mb-2">Khối lớp</label>
                                <select class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-200 focus:border-primary outline-none transition">
                                    <option value="6" selected>Lớp 6</option>
                                    <option value="7">Lớp 7</option>
                                    <option value="8">Lớp 8</option>
                                    <option value="9">Lớp 9</option>
                                </select>
                            </div>
                        </div>

                        <div class="mb-6">
                            <label class="block text-gray-700 text-sm font-bold mb-2">Giới thiệu ngắn</label>
                            <textarea rows="3" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-200 focus:border-primary outline-none transition" placeholder="Sở thích của mình là toán hình..."></textarea>
                        </div>

                        <div class="flex justify-end">
                            <button type="submit" class="bg-primary hover:bg-blue-600 text-white font-bold py-2 px-6 rounded-lg shadow transition transform active:scale-95">
                                Lưu thay đổi
                            </button>
                        </div>
                    </form>
                </div>

                <!-- TAB 2: BẢO MẬT -->
                <div id="tab-security" class="hidden fade-in">
                    <h3 class="text-xl font-bold text-gray-800 mb-1">Đổi mật khẩu</h3>
                    <p class="text-sm text-gray-500 mb-6">Hãy sử dụng mật khẩu mạnh để bảo vệ tài khoản.</p>

                    <form onsubmit="handleSave(event)" class="max-w-md">
                        <div class="mb-4">
                            <label class="block text-gray-700 text-sm font-bold mb-2">Mật khẩu hiện tại</label>
                            <div class="relative">
                                <input type="password" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-200 focus:border-primary outline-none transition">
                                <i class="fa-regular fa-eye absolute right-3 top-3 text-gray-400 cursor-pointer hover:text-gray-600"></i>
                            </div>
                        </div>
                        <div class="mb-4">
                            <label class="block text-gray-700 text-sm font-bold mb-2">Mật khẩu mới</label>
                            <div class="relative">
                                <input type="password" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-200 focus:border-primary outline-none transition">
                            </div>
                        </div>
                        <div class="mb-6">
                            <label class="block text-gray-700 text-sm font-bold mb-2">Nhập lại mật khẩu mới</label>
                            <div class="relative">
                                <input type="password" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-200 focus:border-primary outline-none transition">
                            </div>
                        </div>

                        <div class="flex justify-start">
                            <button type="submit" class="bg-primary hover:bg-blue-600 text-white font-bold py-2 px-6 rounded-lg shadow transition">
                                Cập nhật mật khẩu
                            </button>
                        </div>
                    </form>
                </div>

                <!-- TAB 3: LIÊN KẾT PHỤ HUYNH -->
                <div id="tab-parent" class="hidden fade-in">
                    <h3 class="text-xl font-bold text-gray-800 mb-1">Liên kết phụ huynh</h3>
                    <p class="text-sm text-gray-500 mb-6">Kết nối tài khoản để bố mẹ có thể hỗ trợ việc học của bạn.</p>

                    <!-- TRẠNG THÁI 1: CHƯA LIÊN KẾT (Hiển thị mặc định) -->
                    <div id="parent-unlinked" class="border-2 border-dashed border-gray-300 rounded-xl p-8 text-center bg-gray-50">
                        <div class="w-16 h-16 bg-white rounded-full flex items-center justify-center mx-auto mb-4 shadow-sm text-gray-400">
                            <i class="fa-solid fa-link-slash text-2xl"></i>
                        </div>
                        <h4 class="text-lg font-bold text-gray-700 mb-2">Chưa liên kết tài khoản</h4>
                        <p class="text-gray-500 mb-6 max-w-sm mx-auto">
                            Bạn hãy nhập <strong>Mã liên kết</strong> (Parent Code) lấy từ tài khoản của bố mẹ để kết nối nhé.
                        </p>

                        <div class="max-w-xs mx-auto flex gap-2">
                            <input type="text" id="parent-code-input" placeholder="Nhập mã (VD: PA-1234)" class="flex-1 px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-200 focus:border-secondary outline-none uppercase text-center font-mono tracking-widest">
                            <button onclick="simulateConnect()" class="bg-secondary hover:bg-orange-600 text-white font-bold px-4 py-2 rounded-lg transition">
                                Kết nối
                            </button>
                        </div>
                    </div>

                    <!-- TRẠNG THÁI 2: ĐÃ LIÊN KẾT (Ẩn mặc định, hiện ra khi demo) -->
                    <div id="parent-linked" class="hidden bg-blue-50 border border-blue-100 rounded-xl p-6 flex flex-col md:flex-row items-center gap-6">
                        <div class="relative">
                            <div class="w-20 h-20 bg-orange-100 rounded-full flex items-center justify-center text-3xl text-secondary border-4 border-white shadow-sm">
                                <i class="fa-solid fa-user-tie"></i>
                            </div>
                            <div class="absolute bottom-0 right-0 w-6 h-6 bg-green-500 border-2 border-white rounded-full flex items-center justify-center text-white text-xs">
                                <i class="fa-solid fa-check"></i>
                            </div>
                        </div>
                        <div class="text-center md:text-left flex-1">
                            <h4 class="text-lg font-bold text-gray-800">Phụ huynh: Nguyễn Văn Bố</h4>
                            <p class="text-sm text-green-600 font-bold mb-2"><i class="fa-solid fa-circle-check mr-1"></i>Đã liên kết thành công</p>
                            <p class="text-gray-500 text-sm">Bố mẹ sẽ nhận được báo cáo học tập hàng tuần của bạn qua email.</p>
                        </div>
                        <button onclick="disconnectParent()" class="text-red-500 hover:text-red-700 text-sm font-semibold border border-red-200 hover:bg-red-50 px-4 py-2 rounded-lg transition">
                            Hủy liên kết
                        </button>
                    </div>

                </div>

            </div>
        </div>
    </main>

    <!-- JS Logic -->
    <script>
        function switchTab(tabName) {
            // Update Sidebar
            document.querySelectorAll('.nav-item').forEach(item => {
                item.classList.remove('active', 'bg-blue-50', 'text-blue-600', 'border-l-4', 'border-blue-600', 'font-bold');
                item.classList.add('text-gray-600');
            });

            const activeNav = document.getElementById(`nav-${tabName}`);
            activeNav.classList.add('active'); // CSS class handles the rest

            // Show Content
            document.getElementById('tab-general').classList.add('hidden');
            document.getElementById('tab-security').classList.add('hidden');
            document.getElementById('tab-parent').classList.add('hidden');

            const activeContent = document.getElementById(`tab-${tabName}`);
            activeContent.classList.remove('hidden');
            activeContent.classList.add('fade-in');
        }

        function handleSave(e) {
            e.preventDefault();
            const btn = e.target.querySelector('button[type="submit"]');
            const originalText = btn.innerText;
            btn.innerText = "Đang lưu...";
            btn.disabled = true;

            setTimeout(() => {
                btn.innerText = "Đã lưu thành công!";
                btn.classList.add('bg-green-600');

                setTimeout(() => {
                    btn.innerText = originalText;
                    btn.disabled = false;
                    btn.classList.remove('bg-green-600');
                }, 2000);
            }, 800);
        }

        // Demo logic for Parent Connection
        function simulateConnect() {
            const input = document.getElementById('parent-code-input');
            if(input.value.trim() === "") {
                alert("Vui lòng nhập mã liên kết!");
                return;
            }

            // Fake processing
            input.disabled = true;
            document.getElementById('parent-unlinked').classList.add('opacity-50');

            setTimeout(() => {
                document.getElementById('parent-unlinked').classList.add('hidden');
                document.getElementById('parent-linked').classList.remove('hidden');
                document.getElementById('parent-linked').classList.add('fade-in');
            }, 1000);
        }

        function disconnectParent() {
            if(confirm("Bạn có chắc chắn muốn hủy liên kết?")) {
                document.getElementById('parent-linked').classList.add('hidden');
                document.getElementById('parent-unlinked').classList.remove('hidden', 'opacity-50');
                document.getElementById('parent-code-input').disabled = false;
                document.getElementById('parent-code-input').value = "";
            }
        }
    </script>
</body>
</html>